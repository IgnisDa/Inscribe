<!-- prettier-ignore -->
{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block additional_css %}
<link rel="stylesheet" href="{% static 'notes/css/detail.css' %}" />
{% endblock %}

<!-- prettier-ignore -->
{% block title %}
{{ note.title }}
{% endblock %}

<!-- prettier-ignore -->
{% block body %}
<div class="text-white container">
  <div class="display-4 text-center text-capitalize mt-4">
    <strong class="text-info">{{ note.title }}</strong>
  </div>
  <div class="d-flex justify-content-between">
    <div class="align-self-end d-flex rounded-circle p-2">
      <div
        id="like-button"
        class="mx-2 align-self-center"
        style="cursor: pointer"
      >
        <svg
          id="heart-icon"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          class="text-info"
        >
          <path fill="currentColor" d="M18 1l-6 4-6-4-6 5v7l12 10 12-10v-7z" />
        </svg>
      </div>
      <div class="mx-2 display-6"><strong>{{ bookmarks }}</strong></div>
    </div>
    <div class="display-6 text-right">
      <span class="h3">~ by</span>
      <em class="text-pink">{{ note.writer.full_name }}</em>
    </div>
  </div>
  <div class="text-right">
    <p class="text-warning">{{ note.created_at | date:"M d, Y" }}</p>
  </div>
  <div class="p-5 p-sm-5 markdown-content">
    {{ note.formatted_markdown | safe }}
  </div>
  <form style="display: none">
    <input id="note-id" value="{{ note.id }}" />
  </form>
  <div class="card-body">
    <div class="comment p-5">
      <h3>Add Your Comment</h3>
      {% if not user.is_authenticated %}
      <div class="alert alert-danger" role="alert">
        You need to be <a href="{% url 'accounts:login' %}">logged</a> in to
        post a comment.
      </div>
      {% else %}
      <form method="post" class="mt-3">
        {{ comment_form | crispy }} {% csrf_token %}
        <button type="submit" class="btn btn-primary btn-block my-2">
          Post
        </button>
      </form>
      {% endif %}
    </div>

    <div class="comment-section p-3 m-4">
      <div class="h4 p-2">{{ comments.count }} comment(s)</div>
      <!-- prettier-ignore -->
      {% if comments %}
      {% for comment in comments %}
      {% if comment.is_active %}
      <div class="shadow-lg p-2 rounded-lg my-4">
        <div class="row">
          <div class="col-sm text-info" style="font-size: larger">
            {{ comment.user.full_name }}
          </div>
          <div class="col-sm ml-5 align-self-center">
            {{ comment.posted_on | timesince }} ago
          </div>
        </div>
        <div class="mt-3" style="font-size: large">{{ comment.content }}</div>
      </div>
      <!-- prettier-ignore -->
      {% endif %}
      {% endfor %}
      {% else %}
      <div class="shadow-lg p-2 rounded-lg text-danger display-6">
        No comments, be the first one to comment!
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}

<!-- prettier-ignore -->
{% block additional_js %}
<script src="{% static 'notes/js/detail.js' %}"></script>
{% endblock %}
